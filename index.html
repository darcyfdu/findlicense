<!doctype html>
<html lang="en" class="no-js">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	
 	<link rel="stylesheet" href="http://cdn.static.runoob.com/libs/foundation/5.5.3/css/foundation.min.css">
	<link rel="stylesheet" href="/static/css/reset.css"> <!-- CSS reset -->
	<link rel="stylesheet" href="/static/css/style.css"> <!-- Resource style -->
        <link rel="stylesheet" href="/static/css/bootstrap.min.css">
	<script src="/static/js/modernizr.js"></script> <!-- Modernizr -->
  	<script src="http://cdn.static.runoob.com/libs/jquery/2.1.1/jquery.min.js"></script>
	<script src="http://cdn.static.runoob.com/libs/foundation/5.5.3/js/foundation.min.js"></script>
	<script src="http://cdn.static.runoob.com/libs/foundation/5.5.3/js/vendor/modernizr.js"></script>
	<script src="/static/js/bootstrap.min.js"></script>
	<title>开源许可证检测系统</title>
	  <script type="text/javascript">
		function upload(){
		    var form = document.getElementById("uploadForm");
		    var file = form["file1"].value.toLowerCase();
		    var url = form["giturl"].value.toLowerCase();
		    if(isNull(file)&&isNull(url)){
		        $("#msg").html("必须上传文件或者填写仓库地址");
		        $(".alert").show();
		        return;
		    }
		    if((!isNull(url))&&(!isGiturl(url))){
		        $("#msg").html("仓库地址必须是.git结尾的地址");
		        $(".alert").show();
		        return;
		    }
		    if((!isCompressFile(file))&&isNull(url)){
		        $("#msg").html("压缩文件格式必须是zip、bz2或者gz");
		        $(".alert").show();
		        return;
		    }
		    $(".progress-bar").addClass("active");
		    var p = parseFloat((1 * 100).toFixed(2))+"%";
		        $(".progress-bar").css("width",p).html("上传检测中");
		    form.submit();
		}
		function test(){
		    $("input[type='file']", document.forms[0]).each(function(index,file){
		        file.value = null;
		    });
		}
		function isNull(x){
		    if (x==null || x=="")
		        return true;
		    return false;
		}
		function isCompressFile(x){
		    var index = x.lastIndexOf(".");
		    if(index<1)
		        return false;
		    var format = x.substring(index+1);
		    if (format!="bz2" && format!="gz" && format!="zip"&& format!="xz")
		        return false;
		    return true;
		}
		function isGiturl(x){
		    var index = x.lastIndexOf(".");
		    if(index<1)
		        return false;
		    var format = x.substring(index+1);
		    if (format!="git")
		        return false;
		    return true;
		}
	    </script>
</head>
<body>
	<nav class="cd-side-navigation">
		<ul>
			<li>
				<a href="/" class="selected" data-menu="index">
					<svg class="nc-icon outline" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="24px" height="24px" viewBox="0 0 24 24"><g transform="translate(0, 0)"> <polygon fill="none" stroke="#4a5261" stroke-width="2" stroke-linecap="square" stroke-miterlimit="10" points="12,2 3,10 3,23 9,23 9,16 15,16 15,23 21,23 21,10 " stroke-linejoin="miter"></polygon> </g></svg>
					主页
				</a>
			</li>

			<li>
				<a href="/setting" data-menu="setting">
					<svg class="nc-icon outline" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="24px" height="24px" viewBox="0 0 24 24"><g transform="translate(0, 0)"> <rect x="1" y="1" fill="none" stroke="#4a5261" stroke-width="2" stroke-linecap="square" stroke-miterlimit="10" width="22" height="22" stroke-linejoin="miter"></rect> <rect data-color="color-2" x="5" y="5" fill="none" stroke="#4a5261" stroke-width="2" stroke-linecap="square" stroke-miterlimit="10" width="5" height="5" stroke-linejoin="miter"></rect> <rect data-color="color-2" x="14" y="5" fill="none" stroke="#4a5261" stroke-width="2" stroke-linecap="square" stroke-miterlimit="10" width="5" height="5" stroke-linejoin="miter"></rect> <rect data-color="color-2" x="5" y="14" fill="none" stroke="#4a5261" stroke-width="2" stroke-linecap="square" stroke-miterlimit="10" width="5" height="5" stroke-linejoin="miter"></rect> <rect data-color="color-2" x="14" y="14" fill="none" stroke="#4a5261" stroke-width="2" stroke-linecap="square" stroke-miterlimit="10" width="5" height="5" stroke-linejoin="miter"></rect> </g></svg>
					配置
				</a>
			</li>

			<li>
				<a href="/projects" data-menu="projects">
					<svg class="nc-icon outline" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="24px" height="24px" viewBox="0 0 24 24"><g transform="translate(0, 0)"> <polyline data-color="color-2" fill="none" stroke="#4a5261" stroke-width="2" stroke-linecap="square" stroke-miterlimit="10" points=" 19,7 12,14 5,7 " stroke-linejoin="miter"></polyline> <rect x="1" y="3" fill="none" stroke="#4a5261" stroke-width="2" stroke-linecap="square" stroke-miterlimit="10" width="22" height="18" stroke-linejoin="miter"></rect> <line data-color="color-2" fill="none" stroke="#4a5261" stroke-width="2" stroke-linecap="square" stroke-miterlimit="10" x1="7" y1="15" x2="5" y2="17" stroke-linejoin="miter"></line> <line data-color="color-2" fill="none" stroke="#4a5261" stroke-width="2" stroke-linecap="square" stroke-miterlimit="10" x1="17" y1="15" x2="19" y2="17" stroke-linejoin="miter"></line> </g></svg>
					</svg>
					关于
				</a>
			</li>
		</ul>
	</nav> <!-- .cd-side-navigation -->
	
	<main class="cd-main">
		<section class="cd-section index visible">
			<header>
				<div class="cd-title">
				<div class="container" style="position:fixed;width:100%;height:100%;top;0;left:0">
					<div class="row" style="margin:0 auto;position:relative;top:50%;transform:translateY(-50%);">
					<div class="small-12 medium-8 large-6 small-centered medium-centered large-centered columns">
					      <div class="row">
						      <img src="/static/fudan.jpg" alt="fudan">
					      </div>
					      <div class="panel panel-primary">
					      <div class="panel-heading">
						<h3 class="panel-title">文件上传</h3>
					      </div>
					      <div class="panel-body">
						  <div class="alert alert-danger alert-dismissable" style="display:none;">
						   <button type="button" class="close" onclick="$('.alert').hide();" 
						      aria-hidden="true">
						      &times;
						   </button>
						   <span id="msg">错误提示信息</span>
						</div>
						<form id="uploadForm" action="/test" method="post" enctype="multipart/form-data">
						    <div class="input-group">
						      <span class="input-group-addon" id="basic-addon1">文件</span>
						      <input name="file1" type="file" class="form-control" aria-describedby="basic-addon1">
						    </div>
						    <p></p>
						    <div class="input-group">
						      <span class="input-group-addon" id="basic-addon2">仓库地址</span>
						      <input name="giturl" type="text" class="form-control" aria-describedby="basic-addon1">
						    </div>
						    <p></p>
						    <div class="progress">
						      <div class="progress-bar progress-bar-danger progress-bar-striped active" role="progressbar" aria-valuemin="0" aria-valuemax="100" style="width: 0%">
							上传中
						      </div>
						    </div>
						    </form>
						    <div style="text-align: center;">
							<button type="button" onclick="upload()" class="btn btn-primary" autocomplete="off">
							  上传
							</button>
							<button type="button" onclick="test()" class="btn btn-primary" autocomplete="off">
							  重置
							</button>
						    </div>
					      </div>
					    </div>
					</div>
					</div>
					</div>
			</div>
                 </header>
		</section> <!-- .cd-section -->
	</main> <!-- .cd-main -->

	<div id="cd-loading-bar" data-scale="1" class="index"></div> <!-- lateral loading bar -->
<script src="js/jquery-2.1.4.js"></script>
<script src="js/velocity.min.js"></script>
<script src="js/main.js"></script> <!-- Resource jQuery -->
</body>
</html>
